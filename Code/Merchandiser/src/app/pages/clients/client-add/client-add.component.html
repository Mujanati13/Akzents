<section class="min-h-[calc(100vh-95px)] flex flex-col">
  <div class="flex-1">
    <h2 translate class="flex text-primary-700 mb-8"><app-icon name="clients" class="w-9 flex items-center mr-1 text-primary-700" /><span class="text-[32px] font-bold font-dm">Kunden</span></h2>
    <form [formGroup]="clientForm" (ngSubmit)="onSubmit()" class="flex-1">
      <!-- Client Name with PrimeNG floating label -->
      <div class="mb-8">
        <p-floatlabel variant="in">
          <input pInputText id="name" formControlName="name" autocomplete="off" class="w-[339px] pr-10 py-3 border border-gray-300 focus:outline-none text-gray-700 bg-white" />
          <label for="name">Kundenname</label>
        </p-floatlabel>
      </div>

      <!-- Logo Upload section -->
      <div class="mb-8">
        <app-image-upload label="Logo" [imagePreview]="logoPreview" [fileName]="fileName" (fileSelected)="onImageSelected($event)" (fileRemoved)="onImageRemoved()"></app-image-upload>
      </div>

      <!-- Ansprechpartner Kunde (Contact Persons) -->
      <div class="mb-8">
        <label class="block text-[14px] font-bold text-primary-500 mb-2">Ansprechpartner Kunde</label>

        <!-- PrimeNG Autocomplete with multiple selection -->
        <div class="flex gap-x-2 items-end">
          <p-autocomplete
            [(ngModel)]="contactValue"
            [ngModelOptions]="{ standalone: true }"
            [suggestions]="filteredContacts"
            (completeMethod)="searchContacts($event)"
            (onSelect)="onContactsChanged()"
            (onUnselect)="onContactsChanged()"
            (onChange)="onContactsChanged()"
            [multiple]="true"
            placeholder="Search contacts"
            [styleClass]="'w-[339px] min-h-[46px]'"
          ></p-autocomplete>

          <button type="button" (click)="addCustomContact()" class="px-3 py-1 bg-primary-500 text-white rounded-md font-dm text-[14px] h-[46px] w-[245px]">Neuen Ansprechpartner anlegen</button>
        </div>
      </div>

      <!-- Projektleiter Akzente (Project Managers) -->
      <div class="mb-12">
        <label class="block text-[14px] font-bold text-primary-500 mb-2">Projektleiter Akzente</label>

        <p-autocomplete
          [(ngModel)]="selectedManagers"
          [ngModelOptions]="{ standalone: true }"
          [suggestions]="filteredManagers"
          (completeMethod)="searchManagers($event)"
          (onSelect)="onManagersChanged()"
          (onUnselect)="onManagersChanged()"
          (onChange)="onManagersChanged()"
          [multiple]="true"
          placeholder="Search managers"
          [styleClass]="'w-[339px] min-h-[46px]'"
        ></p-autocomplete>
      </div>
    </form>
  </div>
  <div class="sticky bottom-0 bg-white py-4 pl-6 z-10">
    <div class="flex justify-end">
      <button
        type="button"
        (click)="onSubmit()"
        [disabled]="clientForm?.invalid || isSubmitting"
        class="px-4 py-2 bg-primary-500 hover:bg-primary-700 text-white font-dm cursor-pointer text-[14px] rounded-md transition-colors duration-200 disabled:bg-gray-300 h-[49px] w-[311px]"
      >
        <span>Kunde jetzt anlegen!</span>
      </button>
    </div>
  </div>
</section>
